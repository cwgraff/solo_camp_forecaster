var app=angular.module("campApp",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/login.html",controller:"LoginController"}).when("/selection",{templateUrl:"views/selection.html",controller:"SelectionController"}).when("/result",{templateUrl:"views/result.html",controller:"ResultController"}),b.html5Mode(!0)}]),app.factory("DataService",function(){var a={startDate:0,endDate:0};return a}),app.factory("UserService",["$http","$location",function(a,b){var c={},d=function(d){a.post("/",d).then(function(a){return console.log("Response from POST - ",a),c.server=a.data,c.username=a.data.username,c.isLoggedIn=!0,c.logInTime=new Date,"success"!=a.data?!1:void b.path("selection")})};return{userData:c,makeLoginRequest:d}}]),app.controller("mainController",["$scope","$http","DataService",function(a,b,c){a.selectedList=[],a.dateToday=Date.now()}]),app.controller("LoginController",["$scope","$location","DataService","UserService",function(a,b,c,d){a.sendDataAndStuff=function(){d.makeLoginRequest(a.data)}}]),app.controller("SelectionController",["$scope","$http","DataService",function(a,b,c){a.sample="Selection Angular hooked up correctly",a.dateIt=864e5,a.getList=function(){selectedRegion=a.region,b.get("/getData/"+selectedRegion).then(function(b){function c(b){for(var c=0;c<b.length;c++)for(var d=0;d<a.selectedList.length;)b[c].id==a.selectedList[d].id?(b.splice(c,1),d=0):d++;return b}console.log(b.data),a.parkList=[],a.parkList=c(b.data)})},a.selectLoc=function(b){console.log(b);for(var c=0;c<a.parkList.length;c++)b==a.parkList[c].id&&(console.log(a.parkList[c]),a.selectedList.push(a.parkList.splice(c,1)[0]),console.log(a.parkList))},a.unSelectLoc=function(b){for(var c=0;c<a.selectedList.length;c++)b==a.selectedList[c].id&&(a.selectedList[c].region==selectedRegion||"All"==selectedRegion?a.parkList.push(a.selectedList.splice(c,1)[0]):a.selectedList.splice(c,1))},a.setDateRange=function(){c.startDate=a.dateStart,c.endDate=a.dateEnd}}]),app.controller("ResultController",["$scope","$http","DataService",function(a,b,c){function d(){n.sort(e),console.log(n),a.finalArray=n,l()}function e(a,b){return a.averageTemp<b.averageTemp?1:a.averageTemp>b.averageTemp?-1:0}function f(){for(var b=0,c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b+=c[d].temperatureMax;return b/c.length}function g(){for(var b=0,c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b+=c[d].precipProbability;return b/c.length}function h(){for(var b=[],c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b.push(c[d].summary);return b}function i(){for(var b=[],c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b.push(c[d].time);return b}function j(){for(var b=[],c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b.push(c[d].precipProbability);return b}function k(){for(var b=[],c=m.slice(a.startDate,a.endDate+1),d=0;d<c.length;d++)b.push(c[d].temperatureMax);return b}function l(){for(var b=0;b<a.finalArray[0].dates.length;b++){var c={summaries:a.finalArray[0].summaries[b],dates:a.finalArray[0].dates[b],dailyPrecip:a.finalArray[0].dailyPrecip[b],dailyTemp:a.finalArray[0].dailyTemp[b]};a.dailyArray.push(c)}}a.sample="Result Angular hooked up correctly",a.startDate=Number(c.startDate),a.endDate=Number(c.endDate);var m,n=[];a.dailyArray=[],a.finalArray=[];for(var o=function(c,e){b.jsonp("https://api.forecast.io/forecast/760edd936d31e7c58af4820c05f8a327/"+a.selectedList[c].lat+","+a.selectedList[c]["long"]+"/?exclude=currently,minutely,hourly,alerts,flags&callback=JSON_CALLBACK").then(function(b){m=b.data.daily.data;var c={parkName:e,averageTemp:f(),averagePrecip:g(),summaries:h(),dates:i(),dailyPrecip:j(),dailyTemp:k()};n.push(c),n.length==a.selectedList.length&&d()})},p=0;p<a.selectedList.length;p++)o(p,a.selectedList[p].name)}]);